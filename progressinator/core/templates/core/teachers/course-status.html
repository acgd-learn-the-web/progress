{% extends 'default.html' %}

{% load data %}
{% load grades %}

{% block wrapper %}
  <div class="grid">
    <div class="class unit [ xs-1 s-1 m-1 l-3-5 ] pad-b-1-2">
      <section class="class-desc section-lightest gutter-1-2 pad-t-1-2 pad-b-1-2">
        <h2 class="class-heading push-1-2 giga">Grade overview <a class="right normal italic" href="{{course.url}}">{{course.title}} »</a></h2>
        <dl class="grid">
          <div class="unit [ xs-1-2 m-1-5 ]">
            <dt class="italic milli">№ students</dt>
            <dd class="push-0 yotta bold brand-dark">{{students | length}}</dd>
          </div>
          <div class="unit [ xs-1-2 m-1-5 ]">
            <dt class="italic milli">Grade avg</dt>
            <dd class="push-0 yotta bold brand-dark">{{stats_grade_avg | grade_as_letter}}</dd>
          </div>
          <div class="unit [ xs-1-2 m-1-5 ]">
            <dt class="italic milli">Actual avg</dt>
            <dd class="push-0 yotta bold brand-dark">{{stats_actual_avg | pretty_percent_small}}</dd>
          </div>
          <div class="unit [ xs-1-2 m-2-5 ]">
            <dt class="italic milli">Status avg</dt>
            <dd class="push-0 yotta bold brand-dark">{{stats_grade_avg | grade_as_status}}</dd>
          </div>
        </dl>
      </section>
      <section class="class-desc gutter-1-2 pad-t-1-2">
        <h2 class="class-heading push-1-2 giga">Students</h2>
        <div class="grade-statuses-scroll scrollable">
          <table class="grade-statuses">
            <thead>
              <tr>
                <th scope="col" colspan="8">Name</th>
                <th scope="col" colspan="2">Grade</th>
                <th scope="col" colspan="3">Actual</th>
                <th scope="col" colspan="3">Max</th>
                <th scope="col" colspan="3">Status</th>
                <th scope="col" colspan="5">GitHub</th>
              </tr>
            </thead>
            <tbody>
              {% for student in students %}
                <tr class="grade-status-{{student.current_grade_average | grade_as_status | slugify}}">
                  <th class="grade-item-name" scope="row" colspan="8">
                    <a href="{% url 'core:teacher_user_grades' course_id=course.course user_id=student.user.id %}">{{student.user.last_name}}, {{student.user.first_name}}</a>
                  </th>
                  <td class="grade-item-grade color-pass-dark" colspan="2">
                    <strong>{{student.current_grade_average | grade_as_letter}}</strong>
                    {% if student.current_grade_average < .6 %}
                      <i class="grade-item-grade-icon icon i-1-2"><svg><use xlink:href="#icon-grade-avg-{{student.current_grade_average | grade_as_status | slugify}}"></use></svg></i>
                    {% endif %}
                  </td>
                  <td class="color-grey-dark" colspan="3">{{student.current_grade | pretty_percent_small}}</td>
                  <td class="color-grey" colspan="3">{{student.current_grade_max | pretty_percent_small}}</td>
                  <td class="milli italic" colspan="3">{{student.current_grade_average | grade_as_status}}</td>
                  <td class="milli" colspan="5">
                    <a href="https://github.com/{{student.user.username}}" rel="external">{{student.user.username}}</a>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </section>
    </div>
    <div class="class class-outside unit [ xs-1 s-1 m-1 l-2-5 ] pad-b">
      <section class="class-desc section-muted-medium gutter-1-2 pad-t-1-2 pad-b-1-2">
        <h2 class="class-heading push-1-2 giga">Assessment overview <a class="right normal italic" href="{{course.url}}#marking-scheme">Grade scheme »</a></h2>
        <dl class="grid push-1-2">
          <div class="unit [ xs-1-2 m-1-2 ]">
            <dt class="italic milli">№ assessments</dt>
            <dd class="push-0 yotta bold">{{stats_assessments_no_zeros}} <span class="color-grey-dark not-bold">({{stats_assessments_total}})</span></dd>
          </div>
          <div class="unit [ xs-1-2 m-1-2 ]">
            <dt class="italic milli">Pass rate avg</dt>
            <dd class="push-0 yotta bold">{{stats_pass_rate_avg | pretty_percent_small}}</dd>
          </div>
        </dl>
        <hr class="hr-dark push-1-2">
        <dl class="grid">
          <div class="unit [ xs-1-3 m-1-5 l-1-5 ]">
            <dt class="italic milli">№&nbsp;videos</dt>
            <dd class="push-0 milli"><span class="bold">{{course.totals.videos}}</span> ≈{{course.totals.videos_each_algonquin | pretty_percent_small}}</dd>
          </div>
          <div class="unit [ xs-1-3 m-1-5 l-1-5 ]">
            <dt class="italic milli">№&nbsp;activities</dt>
            <dd class="push-0 milli"><span class="bold">{{course.totals.activities}}</span> ≈{{course.totals.activities_each_algonquin | pretty_percent_small}}</dd>
          </div>
          <div class="unit [ xs-1-3 m-1-5 l-1-5 ]">
            <dt class="italic milli">№&nbsp;lessons</dt>
            <dd class="push-0 milli"><span class="bold">{{course.totals.activities}}</span> ≈{{course.totals.activities_each_algonquin | pretty_percent_small}}</dd>
          </div>
          <div class="unit [ xs-1-3 m-1-5 l-1-5 ]">
            <dt class="italic milli">№&nbsp;exercises</dt>
            <dd class="push-0 milli"><span class="bold">{{course.totals.exercises}}</span> ≈{{course.totals.exercises_each_algonquin | pretty_percent_small}}</dd>
          </div>
          <div class="unit [ xs-1-3 m-1-5 l-1-5 ]">
            <dt class="italic milli">№&nbsp;projects</dt>
            <dd class="push-0 milli"><span class="bold">{{course.totals.projects}}</span> ≈{{course.totals.projects_each_algonquin | pretty_percent_small}}</dd>
          </div>
        </dl>
      </section>
      <section class="class-desc gutter-1-2 pad-t-1-2">
        <h2 class="class-heading push-1-2 giga">Assessments</h2>
        <div class="assessment-statuses-scroll scrollable">
          <table class="assessment-statuses">
            <thead>
              <tr>
                <th scope="col" colspan="11">Name</th>
                <th scope="col" colspan="4">Late</th>
                <th scope="col" colspan="4">Worth</th>
                <th scope="col" colspan="5">Pass rate</th>
              </tr>
            </thead>
            <tbody>
              {% for item in course.assessments %}
                <tr>
                  <th scope="row" colspan="11">
                    {% if item.assessment_each_algonquin == 0 %}
                      <a class="not-bold" href="#">{{item.name}}</a>
                    {% else %}
                      <a href="#">{{item.name}}</a>
                    {% endif %}
                  </th>
                  <td class="milli color-grey" colspan="4">{{item.assessment_type | title}}</td>
                  <td class="color-grey" colspan="4">≈{{item.assessment_each_algonquin | pretty_percent_small}}</td>
                  <td colspan="5">{{item.total_students_pass_rate | pretty_percent_small}}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </section>
    </div>
  </div>
{% endblock %}
